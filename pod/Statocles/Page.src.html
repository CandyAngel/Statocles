<!DOCTYPE html>
<html>
    <head>
        <link href="/Statocles/theme/css/normalize.css" rel="stylesheet">
        <link href="/Statocles/theme/css/skeleton.css" rel="stylesheet">
        <link href="/Statocles/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Statocles</title>
        <link href="http://fonts.googleapis.com/css?family=Forum" rel="stylesheet" type="text/css">
<style>
    h1, h2, h3, h4, h5, h6 {
        font-family: 'Forum', sans-serif;
        font-weight: bold;
    }

    #index-banner {
        font-family: 'Forum', sans-serif;
        height: 300px;
        position: relative;
        margin-bottom: 1em;
        border-bottom: 1px solid #777
    }
    #index-banner:before, #index-banner:after {
        width: 60px;
        height: 300px;
        content: url(/Statocles/theme/images/column.png);
    }
    #index-banner:before {
        position: absolute;
        top: 0;
        left: 0;
    }
    #index-banner:after {
        position: absolute;
        top: 0;
        right: 0;
    }

    #index-banner h1 {
        padding-top: 1em;
        text-transform: uppercase;
        font-size: 72px;
        text-align: center;
    }
    #index-banner h1 small {
        display: block;
        font-size: 24px;
    }

    #index-banner .latest-release {
        text-align: center;
    }

</style>

    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/Statocles/">Statocles</a>
                    <ul>
                        <li>
                            <a href="/Statocles/blog">Blog</a>
                        </li>
                        <li>
                            <a href="/Statocles/pod">Docs</a>
                        </li>
                        <li>
                            <a href="/Statocles/gallery">Gallery</a>
                        </li>
                        <li>
                            <a href="http://github.com/preaction/Statocles">Code</a>
                        </li>
                        <li>
                            <a href="http://github.com/preaction/Statocles/issues">Bugs</a>
                        </li>
                        <li>
                            <a href="http://metacpan.org/pod/Statocles">CPAN</a>
                        </li>
                        <li>
                            <a href="https://chat.mibbit.com/?channel=%23statocles&amp;server=irc.perl.org">IRC</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            <a href="https://github.com/preaction/Statocles"><img alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" style="position: absolute; top: 0; right: 0; z-index: 1000; border: 0;"></a>

        </header>
        <div class="main container">
            <a class="button" href="/Statocles/pod/Statocles/Page.html">
    Back to documentation
</a>
<pre>package Statocles::Page;
# ABSTRACT: Base class for rendering objects

use Statocles::Base &#39;Role&#39;;
use Statocles::Template;

=attr site

The site this page is part of.

=cut

has site =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; InstanceOf[&#39;Statocles::Site&#39;],
    lazy =&gt; 1,
    default =&gt; sub { $Statocles::SITE },
);

=attr app

The application this page came from, so we can give it to the templates.

=cut

has app =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; ConsumerOf[&#39;Statocles::App&#39;],
);

=attr path

The absolute URL path to save this page to.

=cut

has path =&gt; (
    is =&gt; &#39;rw&#39;,
    isa =&gt; Path,
    coerce =&gt; Path-&gt;coercion,
    required =&gt; 1,
);

=attr title

The title of the page.

=cut

has title =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; Str,
);

=attr type

The MIME type of this page. By default, will use the L&lt;path&#39;s|/path&gt; file extention
to detect a likely type.

=cut

our %TYPES = (
    # text
    html =&gt; &#39;text/html&#39;,
    markdown =&gt; &#39;text/markdown&#39;,
    css =&gt; &#39;text/css&#39;,

    # image
    jpg =&gt; &#39;image/jpeg&#39;,
    jpeg =&gt; &#39;image/jpeg&#39;,
    png =&gt; &#39;image/png&#39;,
    gif =&gt; &#39;image/gif&#39;,

    # application
    rss =&gt; &#39;application/rss+xml&#39;,
    atom =&gt; &#39;application/atom+xml&#39;,
    js =&gt; &#39;application/javascript&#39;,
    json =&gt; &#39;application/json&#39;,
);

has type =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; Str,
    lazy =&gt; 1,
    default =&gt; sub {
        my ( $self ) = @_;
        my ( $ext ) = $self-&gt;path =~ /[.]([^.]+)$/;
        return $TYPES{ $ext };
    },
);

=attr date

The date of this page. Used for last updated date and blog post dates.

=cut

has date =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; InstanceOf[&#39;Time::Piece&#39;],
    lazy =&gt; 1,
    default =&gt; sub { Time::Piece-&gt;new },
);

=attr data

A hash of additional template variables for this page.

=cut

has data =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; HashRef,
    default =&gt; sub { {} },
);

=attr links

A hash of arrays of links to pages related to this page. Possible keys:

    feed        - Feed pages related to this page
    alternate   - Alternate versions of this page posted to other sites

Each item in the array is a L&lt;link object|Statocles::Link&gt;. The most common
attributes are:

    text        - The text of the link
    href        - The page for the link
    type        - The MIME type of the link, optional

=cut

has _links =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; LinkHash,
    lazy =&gt; 1,
    default =&gt; sub { +{} },
    coercion =&gt; LinkHash-&gt;coercion,
    init_arg =&gt; &#39;links&#39;,
);

=attr markdown

The markdown object to render document Markdown. Defaults to L&lt;the markdown
attribute from the Site object|Statocles::Site/markdown&gt;.

Any object with a &quot;markdown&quot; method will work.

=cut

has markdown =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; HasMethods[&#39;markdown&#39;],
    default =&gt; sub { $_[0]-&gt;site-&gt;markdown },
);

=attr template

The main L&lt;template|Statocles::Template&gt; for this page. The result will be
wrapped in the L&lt;layout template|/layout&gt;.

=cut

my @template_attrs = (
    is =&gt; &#39;ro&#39;,
    isa =&gt; InstanceOf[&#39;Statocles::Template&#39;],
    coerce =&gt; Statocles::Template-&gt;coercion,
    default =&gt; sub {
        Statocles::Template-&gt;new( content =&gt; &#39;&lt;%= $content %&gt;&#39; ),
    },
);

has template =&gt; @template_attrs;

=attr layout

The layout L&lt;template|Statocles::Template&gt; for this page, which will wrap the content generated by the
L&lt;template|/template&gt;.

=cut

has layout =&gt; @template_attrs;

=attr search_change_frequency

How frequently a search engine should check this page for changes. This is used
in the L&lt;sitemap.xml|http://www.sitemaps.org&gt; to give hints to search engines.

Should be one of:

    always
    hourly
    daily
    weekly
    monthly
    yearly
    never

Defaults to C&lt;weekly&gt;.

B&lt;NOTE:&gt; This is only a hint to search engines, not a command. Pages marked C&lt;hourly&gt;
may be checked less often, and pages marked C&lt;never&gt; may still be checked once in a
while. C&lt;never&gt; is mainly used for archived pages or permanent links.

=cut

has search_change_frequency =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; Enum[qw( always hourly daily weekly monthly yearly never )],
    default =&gt; sub { &#39;weekly&#39; },
);

=attr search_priority

How high should this page rank in search results compared to similar pages on
this site?  This is used in the L&lt;sitemap.xml|http://www.sitemaps.org&gt; to rank
individual, full pages more highly than aggregate, list pages.

Value should be between C&lt;0.0&gt; and C&lt;1.0&gt;. The default is C&lt;0.5&gt;.

This is only used to decide which pages are more important for the search
engine to crawl, and which pages within your site should be given to users. It
does not improve your rankings compared to other sites. See L&lt;the sitemap
protocol|http://sitemaps.org&gt; for details.

=cut

has search_priority =&gt; (
    is =&gt; &#39;ro&#39;,
    isa =&gt; Num,
    default =&gt; sub { 0.5 },
);

=method vars

    my %vars = $page-&gt;vars;

Get extra template variables for this page

=cut

sub vars { }

=method render

    my $html = $page-&gt;render( %vars );

Render the page, using the L&lt;template|Statocles::Page/template&gt; and wrapping
with the L&lt;layout|Statocles::Page/layout&gt;. Give any extra C&lt;%vars&gt; to the
template, layout, and page C&lt;content&gt; method (if applicable).

=cut

sub render {
    my ( $self, %args ) = @_;
    my %vars = (
        %{ $self-&gt;data },
        %args,
        self =&gt; $self,
        app =&gt; $self-&gt;app,
        $self-&gt;vars,
    );

    my $content = $self-&gt;template-&gt;render(
        # XXX: This is suboptimal. Isn&#39;t vars() enough?
        ( $self-&gt;can( &#39;content&#39; ) ? ( content =&gt; $self-&gt;content( %vars ) ) : () ),
        %vars,
    );

    return $self-&gt;layout-&gt;render(
        content =&gt; $content,
        %vars,
    );
}

=method links

    my @links = $page-&gt;links( $key );
    my $link = $page-&gt;links( $key );

Get the links set for the given key. See L&lt;the links attribute|/links&gt; for some
commonly-used keys. Returns a list of L&lt;link objects|Statocles::Link&gt;. In
scalar context, returns the first link in the list.

=cut

sub links {
    my ( $self, $name ) = @_;
    my @links = $self-&gt;_links-&gt;{ $name } ? @{ $self-&gt;_links-&gt;{ $name } } : ();
    return wantarray ? @links : $links[0];
}

=method basename

    my $name = $page-&gt;basename;

Get the base file name of this page. Everything after the last C&lt;/&gt;.

=cut

sub basename {
    my ( $self ) = @_;
    return $self-&gt;path-&gt;basename;
}

=method dirname

    my $dir = $page-&gt;dirname;

Get the full directory to this page. Anything that isn&#39;t part of L&lt;/basename&gt;.

There will not be a trailing slash unless it is the root directory.

=cut

sub dirname {
    my ( $self ) = @_;
    return $self-&gt;path-&gt;parent-&gt;stringify;
}

1;
__END__

=head1 DESCRIPTION

A Statocles::Page takes one or more L&lt;documents|Statocles::Document&gt; and
renders them into one or more HTML pages using a main L&lt;template|/template&gt;
and a L&lt;layout template|/layout&gt;.

=head1 SEE ALSO

=over

=item L&lt;Statocles::Page::Document&gt;

A page that renders a single document.

=item L&lt;Statocles::Page::List&gt;

A page that renders a list of other pages.

=back

</pre>

        </div>
        <footer>
            <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61295159-3', 'auto');
  ga('send', 'pageview');

</script>

            <div class="container tagline">
                <a href="http://preaction.github.io/Statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
