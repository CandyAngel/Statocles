<!DOCTYPE html>
<html>
    <head>
        <link href="/Statocles/theme/css/normalize.css" rel="stylesheet">
        <link href="/Statocles/theme/css/skeleton.css" rel="stylesheet">
        <link href="/Statocles/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Statocles</title>
        <meta content="Statocles 0.056" name="generator">
        <link href="http://fonts.googleapis.com/css?family=Forum" rel="stylesheet" type="text/css">
<style>
    h1, h2, h3, h4, h5, h6 {
        font-family: 'Forum', sans-serif;
        font-weight: bold;
    }

    #index-banner {
        font-family: 'Forum', sans-serif;
        height: 300px;
        position: relative;
        margin-bottom: 1em;
        border-bottom: 1px solid #777
    }
    #index-banner:before, #index-banner:after {
        width: 60px;
        height: 300px;
        content: url(http://preaction.me/statocles//theme/images/column.png);
    }
    #index-banner:before {
        position: absolute;
        top: 0;
        left: 0;
    }
    #index-banner:after {
        position: absolute;
        top: 0;
        right: 0;
    }

    #index-banner h1 {
        padding-top: 1em;
        text-transform: uppercase;
        font-size: 72px;
        text-align: center;
    }
    #index-banner h1 small {
        display: block;
        font-size: 24px;
    }

    #index-banner .latest-release {
        text-align: center;
    }

</style>
<link href="http://preaction.github.io/Statocles/pod/Statocles/Help/Deploy/" rel="canonical">
<script>
    if ( location.href.indexOf( "http://preaction.me/statocles/" ) == -1 ) {
        location.href = "http://preaction.github.io/Statocles/pod/Statocles/Help/Deploy/";
    }
</script>

    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/Statocles/">Statocles</a>
                    <ul>
                        <li>
                            <a href="/Statocles/blog">Blog</a>
                        </li>
                        <li>
                            <a href="/Statocles/pod">Docs</a>
                        </li>
                        <li>
                            <a href="/Statocles/gallery">Gallery</a>
                        </li>
                        <li>
                            <a href="http://github.com/preaction/Statocles">Code</a>
                        </li>
                        <li>
                            <a href="http://github.com/preaction/Statocles/issues">Bugs</a>
                        </li>
                        <li>
                            <a href="http://metacpan.org/pod/Statocles">CPAN</a>
                        </li>
                        <li>
                            <a href="https://chat.mibbit.com/?channel=%23statocles&amp;server=irc.perl.org">IRC</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            <a href="https://github.com/preaction/Statocles"><img alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" style="position: absolute; top: 0; right: 0; z-index: 1000; border: 0;"></a>

        </header>
        <div class="main container">
            <div class="crumbtrail">
<ul>
    <li>
        <a href="/Statocles/pod/Statocles/">Statocles</a>
    </li>
    <li>
        <a href="/Statocles/pod/">Help</a>
    </li>
    <li>
        <a href="/Statocles/pod/Statocles/Help/Deploy/">Deploy</a>
    </li>
</ul>
(<a href="/Statocles/pod/Statocles/Help/Deploy/source.html">source</a>)
</div>
<h1 id="NAME">NAME</h1>

<p>Statocles::Help::Deploy - How to deploy a Statocles site</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This document describes various ways to deploy a Statocles site.</p>

<h2 id="base_url"><code>base_url</code></h2>

<p>Both the site and every deploy can have a <code>base_url</code>, which should be set to the full URL the site will be deployed to, like <code>http://example.com/</code> or <code>http://example.com/path</code>.</p>

<p>Any time a full URL is needed, the <code>base_url</code> will be used to create one. Even better, if there is a <code>/path</code>, all internal links will be rewritten to prepend the <code>/path</code>, making it easy to move a site to a different URL path.</p>

<h1 id="Github-Pages">Github Pages</h1>

<p>By far the easiest way is to deploy to a <a href="http://pages.github.com" rel="external">Github Pages</a> site (though you can <a href="#Custom-Git-Deploy">make your own Git-based deployment</a> as well).</p>

<h2 id="user.github.io">user.github.io</h2>

<p>To make a user site, accessed at http://user.github.io, you need to create a repository called &quot;&lt;user&gt;.github.io&quot;, replacing &lt;user&gt; with your username.</p>

<p>Once you have that, you can start your Statocles site. Your deploy is configured very simply, with the default branch of &quot;master&quot; being correct:</p>

<pre><code>    # site.yml
    gh_deploy:
        class: Statocles::Deploy::Git

    site:
        class: Statocles::Site
        args:
            deploy: { $ref: gh_deploy }</code></pre>

<h2 id="user.github.io-project">user.github.io/project</h2>

<p>If you have an existing project that you want to add a Github Pages site to, you can do so by creating a branch named &quot;gh-pages&quot;. Create the branch as an orphan branch so that you don&#39;t attach yourself to the regular history of the project. Leaving the branch attached to the main history can make things a bit more complicated if that history needs to change, but git will also show the branches as related in a graph (which they are not).</p>

<pre><code>    $ git checkout -b --orphan gh-pages
    $ git reset --hard &#39;HEAD&#39;
    $ git add .gitignore
    $ git commit -m&#39;starting github pages site&#39;
    $ git checkout master</code></pre>

<p>Now we just have to configure a Git deploy to point to our &quot;gh-pages&quot; branch, and make sure to rewrite our page URLs to the right directory.</p>

<pre><code>    # site.yml
    gh_deploy:
        class: Statocles::Deploy::Git
        args:
            branch: gh-pages
            base_url: http://user.github.io/project

    site:
        class: Statocles::Site
        args:
            deploy: { $ref: gh_deploy }</code></pre>

<h1 id="Custom-Git-Deploy">Custom Git Deploy</h1>

<p>To create a Github-Pages-like deploy without hosting on Github, you need a few things:</p>

<ol>

<li><p>A bare repository to push to</p>

</li>
<li><p>A git hook to check out the site&#39;s files</p>

</li>
</ol>

<p>To set up a bare repository to push to, I recommend <a href="http://gitolite.com" rel="external">gitolite</a>. Gitolite manages git repositories for you, making it easy to add/remove them.</p>

<p>If you do not want to use gitolite, you can probably just use SSH:</p>

<pre><code>    $ ssh example.com
    $ mkdir www.example.com
    $ cd www.example.com
    $ git init --bare</code></pre>

<p>Before we&#39;re done on the server, we need to add our git hook. Since a bare repo doesn&#39;t have a working copy of the files, the hook is going to check out the site&#39;s HTML files into a directory we specify (we&#39;ll use <code>/var/www/www.example.com</code> for this example... dot com)</p>

<pre><code>    $ mkdir /var/www/www.example.com
    $ echo &quot;GIT_WORK_TREE=/var/www/www.example.com git checkout -f&quot; &gt; hooks/post-receive
    $ chmod +x hooks/post-receive
    $ exit</code></pre>

<p>Now that the bare repository is ready, you can deploy your site. First, we add the remote manually:</p>

<pre><code>    $ git remote add deploy ssh://example.com/www.example.com.git</code></pre>

<p>Now we can set up our Deploy object:</p>

<pre><code>    # site.yml
    git_deploy:
        class: Statocles::Deploy::Git
        args:
            remote: deploy</code></pre>

<p>And give it to our site:</p>

<pre><code>    # site.yml
    site:
        class: Statocles::Site
        args:
            deploy: { $ref: git_deploy }</code></pre>

<p>Now when we run <code>statocles deploy</code>, our repository will be updated and so will our web root <code>/var/www/www.example.com</code>.</p>

<h1 id="File">File</h1>

<p>If you only need to copy the files to another directory to serve them, if you&#39;re writing the site on the web server, or you&#39;ve got a Jenkins server that can build the site, you can use the <a href="/Statocles/pod/Statocles/Deploy/File/">File deploy</a>. This deploy simply copies the built website to another directory.</p>

<pre><code>    # site.yml
    file_deploy:
        class: Statocles::Deploy::File
        args:
            path: /var/www/www.example.com

    site:
        class: Statocles::Site
        args:
            deploy: { $ref: file_deploy }</code></pre>

<p>This is the default deploy. If you just give a path to the site object, the site will be copied to that path:</p>

<pre><code>    site:
        class: Statocles::Site
        args:
            deploy: /var/www/www.example.com</code></pre>

<h1 id="Custom-Deploy-Module">Custom Deploy Module</h1>

<p>If none of these work for you, you can build your own deploy module. See <a href="/Statocles/pod/Statocles/Deploy/">Statocles::Deploy</a> for details.</p>



        </div>
        <footer>
            <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61295159-3', 'auto');
  ga('send', 'pageview');

</script>

            <div class="container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
